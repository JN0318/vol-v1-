@st.cache_data
def load_data():
    # --- 1.1 球員個人數據 (擴充至 30 名球員，覆蓋所有隊伍) ---
    data = {
        '姓名': ['Lopez, M.', 'Muserskiy, D.', 'Nimir, A.', '高橋藍', '西田有志', '蔡沛彰', '柳田将洋', '水町泰杜', '清水邦広', '関田誠大', '古賀太一郎', '深津英臣', '大宅真樹', '山内晶大', '宮浦健人', '彭世坤', '井上航', 
                 '新井雄大', '小川猛', '張秉承', '大塚達宣', '小野寺太志', '本間隆太', '福山汰一', '甲斐優斗', '西本拳太郎', '高松卓矢', '藤中謙也', '陳建禎', '傳田亮'],
        
        '位置': ['OH', 'OP', 'OP', 'OH', 'OP', 'MB', 'OH', 'OP', 'OP', 'S', 'L', 'S', 'S', 'MB', 'OP', 'MB', 'L', 
                 'OH', 'MB', 'OH', 'OH', 'MB', 'L', 'MB', 'OH', 'S', 'OH', 'OH', 'OH', 'MB'],
        
        '隊伍': [
            'OSAKA BLUTEON', 'SUNTORY SUNBIRDS', 'WOLFDOGS NAGOYA', 'SUNTORY SUNBIRDS', 'PANTHERS', 'NIPPON STEEL SAKAI', 'TOKYO GREAT BEARS', 'WOLFDOGS NAGOYA', 'PANTHERS', 'JTEKT STINGS',
            'TOKYO GREAT BEARS', 'WOLFDOGS NAGOYA', 'JTEKT STINGS', 'PANTHERS', 
            'TORAY ARROWS SHIZUOKA', 'VC FUKUOKA', 'VOLEAS HOKKAIDO', # 原有球員

            'JTEKT STINGS', 'OSAKA BLUTEON', 'NIPPON STEEL SAKAI', 'PANTHERS', 'SUNTORY SUNBIRDS', 'JTEKT STINGS', 'WOLFDOGS NAGOYA', 'TORAY ARROWS SHIZUOKA', 'TOKYO GREAT BEARS', 
            'VC FUKUOKA', 'NIPPON STEEL SAKAI', 'OSAKA BLUTEON', 'VOLEAS HOKKAIDO' # 新增球員
        ],
        
        '總得分': [550, 600, 580, 450, 400, 300, 350, 420, 380, 150, 0, 120, 140, 280, 410, 220, 0, 
                  320, 180, 250, 390, 240, 0, 190, 350, 100, 290, 210, 230, 200],
        '總進攻次數': [950, 1000, 980, 750, 700, 450, 720, 780, 700, 100, 0, 90, 110, 400, 700, 380, 0, 
                     600, 300, 450, 650, 400, 0, 350, 580, 80, 500, 400, 420, 300],
        '成功扣球數': [500, 520, 490, 380, 350, 240, 300, 380, 320, 80, 0, 70, 80, 220, 350, 190, 0, 
                      280, 150, 200, 350, 210, 0, 170, 300, 50, 260, 180, 200, 170],
        '接發球總次數': [450, 50, 40, 600, 30, 5, 550, 80, 20, 10, 800, 5, 8, 5, 40, 10, 750, 
                        400, 10, 300, 450, 10, 700, 15, 300, 5, 400, 300, 350, 10],
        '接發球成功次數': [250, 25, 15, 300, 10, 0, 280, 40, 5, 5, 450, 2, 3, 0, 15, 0, 400, 
                          200, 0, 150, 220, 0, 380, 0, 150, 0, 200, 150, 180, 0],
        '發球得分': [30, 40, 50, 25, 35, 10, 20, 30, 20, 10, 0, 25, 30, 15, 20, 10, 0, 
                    15, 5, 10, 15, 10, 0, 10, 20, 15, 5, 10, 10, 5],
        '攔網得分': [20, 40, 40, 45, 15, 50, 30, 10, 25, 50, 0, 15, 20, 45, 30, 20, 0, 
                    25, 30, 40, 25, 30, 0, 10, 30, 20, 15, 20, 20, 25],
        '總舉球次數': [0, 0, 0, 0, 0, 0, 0, 0, 0, 2000, 0, 2500, 2200, 0, 0, 0, 0, 
                      0, 0, 0, 0, 0, 0, 0, 0, 1800, 0, 0, 0, 0],
        '舉球成功次數': [0, 0, 0, 0, 0, 0, 0, 0, 0, 850, 0, 1100, 950, 0, 0, 0, 0, 
                        0, 0, 0, 0, 0, 0, 0, 0, 800, 0, 0, 0, 0],
        '身高 (cm)': [190, 218, 200, 188, 186, 195, 188, 187, 190, 182, 170, 183, 178, 201, 195, 200, 178, 
                      190, 185, 192, 191, 197, 180, 195, 200, 185, 186, 190, 192, 190],
        '體重 (kg)': [85, 105, 95, 78, 80, 88, 77, 75, 82, 75, 68, 77, 73, 90, 88, 95, 72, 
                      85, 78, 85, 80, 90, 70, 88, 90, 79, 80, 85, 85, 83],
        '獲獎紀錄': [
            'V. MVP, Best 6', 'V. MVP, Best 6', 'V. MVP, Best Server', 'Best 6, 最佳接發', 
            'V. Score King', '亞洲錦標賽最佳MB', '奧運代表', '無', '天皇杯MVP', 'V. Best Setter', 
            '亞洲最佳自由球員', 'V. Best Setter', '無', 'V. Best 6, 攔網王', '無', '無', '無',
            '無', '無', '無', '無', '無', 'V. Best Libero', '無', '無', '無', '無', '無', '無', '無'
        ]
    }
    df = pd.DataFrame(data)

    # --- 1.2 模擬歷年球隊比賽成績 (2023-2025 賽季歷史數據) ---
    historical_data = {
        '年份': [2025, 2024, 2023, 2025, 2024, 2023, 2025, 2024, 2023, 2024, 2023, 2024, 2023],
        '隊伍': [
            'SUNTORY SUNBIRDS', 'SUNTORY SUNBIRDS', 'SUNTORY SUNBIRDS', 
            'WOLFDOGS NAGOYA', 'WOLFDOGS NAGOYA', 'WOLFDOGS NAGOYA', 
            'PANTHERS', 'PANTHERS', 'PANTHERS',
            'JTEKT STINGS', 'JTEKT STINGS',
            'OSAKA BLUTEON', 'OSAKA BLUTEON'
        ],
        '聯賽排名': [1, 2, 3, 3, 1, 2, 2, 3, 1, 4, 5, 6, 7],
        '總決賽結果': ['冠軍', '亞軍', '四強', '四強', '冠軍', '亞軍', '亞軍', '四強', '冠軍', '無緣', '無緣', '無緣', '無緣']
    }
    df_history = pd.DataFrame(historical_data)

    # --- 1.3 指標計算 ---
    df['進攻決定率'] = np.where(df['總進攻次數'] > 0, (df['成功扣球數'] / df['總進攻次數']) * 100, 0)
    df['接發球成功率'] = np.where(df['接發球總次數'] > 0, (df['接發球成功次數'] / df['接發球總次數']) * 100, 0)
    df['舉球效率'] = np.where(df['總舉球次數'] > 0, (df['舉球成功次數'] / df['總舉球次數']) * 100, 0)
    df['扣球得分'] = df['總得分'] - df['發球得分'] - df['攔網得分']
    
    return df, df_history
